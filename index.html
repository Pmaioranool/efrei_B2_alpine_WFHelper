<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nouvelles de Warframe</title>
    <script defer src="https://unpkg.com/alpinejs"></script>
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li><a href="assets/html/cycle.html">cycles zones ouvertes</a></li>
      </ul>
    </nav>

    <section x-data="warframeNews()" x-init="fetchNews()">
      <h2>Nouvelles de Warframe (PC)</h2>
      <template x-for="newsItem in news" :key="newsItem.id">
        <div class="news-item">
          <a x-bind:href="newsItem.link" target="_blank">
            <h3 x-text="newsItem.message"></h3>
            <img :src="newsItem.imageLink" alt="" />
            <p x-text="formatDate(newsItem.date)"></p>
          </a>
        </div>
      </template>
    </section>

    <script>
      function warframeNews() {
        return {
          news: [],
          fetchNews() {
            fetch("https://api.warframestat.us/pc/news")
              .then((response) => {
                if (!response.ok) {
                  throw new Error("Erreur de réseau");
                }
                return response.json();
              })
              .then((data) => {
                this.news = data;
                this.news.reverse();
              })
              .catch((error) => {
                console.error(
                  "Erreur lors de la récupération des données : ",
                  error
                );
              });
          },
          formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString("fr-FR", {
              dateStyle: "medium",
              timeStyle: "short",
            });
          },
        };
      }
    </script>
  </body>
</html>
